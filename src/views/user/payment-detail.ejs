<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>UMCental - Detail <%= type === 'payment' ? 'Pembayaran' : 'Denda' %></title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet" />
    <style>
        .bg-custom-dark { background-color: #181C14; }
        .bg-custom-green { background-color: #697565; }
        .text-custom-green { color: #697565; }
        .border-custom-green { border-color: #697565; }
        .bg-custom-light-beige { background-color: #f5f0e9; }
        .text-custom-brown { color: #7f7a75; }
        .hover\:bg-custom-green-dark:hover { background-color: #5a6356; }
    </style>
</head>
<body class="flex min-h-screen bg-custom-light-beige">
    <%- include('../partials/sidebar') %>
    <div class="flex-1 flex flex-col">
        <%- include('../partials/header') %>
        <main class="flex-1 p-6 md:p-10">
            <!-- Header -->
            <div class="mb-8">
                <div class="flex items-center mb-4">
                    <a href="/user/payments" class="text-custom-green hover:text-custom-brown mr-4">
                        <i class="fas fa-arrow-left"></i> Kembali ke Riwayat
                    </a>
                </div>
                <h1 class="text-3xl font-bold text-custom-dark mb-2">
                    Detail <%= type === 'payment' ? 'Pembayaran' : 'Denda' %>
                </h1>
                <p class="text-custom-brown">
                    Informasi lengkap <%= type === 'payment' ? 'pembayaran' : 'denda' %> untuk pesanan #<%= orderData.id %>
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Main Content -->
                <div class="lg:col-span-2 space-y-6">
                    <!-- Payment/Fine Information -->
                    <div class="bg-white rounded-xl shadow-md border border-gray-200 p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h2 class="text-xl font-semibold text-custom-dark">
                                Informasi <%= type === 'payment' ? 'Pembayaran' : 'Denda' %>
                            </h2>
                            <span class="px-3 py-1 text-sm font-semibold rounded-full <%= getStatusClass(paymentData.status) %>">
                                <%= getStatusText(paymentData.status) %>
                            </span>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h3 class="text-lg font-medium text-custom-dark mb-4">Detail Transaksi</h3>
                                <div class="space-y-3">
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">ID <%= type === 'payment' ? 'Pembayaran' : 'Denda' %>:</span>
                                        <span class="font-medium">#<%= paymentData.id %></span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Jumlah:</span>
                                        <span class="font-medium text-lg"><%= formatNumber(paymentData.amount) %></span>
                                    </div>
                                    <% if (type === 'payment') { %>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Tipe Pembayaran:</span>
                                            <span class="font-medium">
                                                <% if (paymentData.paymentType === 'full') { %>Lunas<% } %>
                                                <% if (paymentData.paymentType === 'deposit') { %>DP<% } %>
                                                <% if (paymentData.paymentType === 'installment') { %>Cicilan<% } %>
                                            </span>
                                        </div>
                                    <% } %>
                                    <% if (type === 'fine') { %>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Alasan Denda:</span>
                                            <span class="font-medium"><%= paymentData.reason || '-' %></span>
                                        </div>
                                        <% if (paymentData.dueDate) { %>
                                            <div class="flex justify-between">
                                                <span class="text-gray-600">Tanggal Jatuh Tempo:</span>
                                                <span class="font-medium"><%= formatDate(paymentData.dueDate) %></span>
                                            </div>
                                        <% } %>
                                    <% } %>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Metode Pembayaran:</span>
                                        <span class="font-medium"><%= paymentData.paymentMethod || '-' %></span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Tanggal <%= type === 'payment' ? 'Pembayaran' : 'Denda' %>:</span>
                                        <span class="font-medium">
                                            <%= formatDate(type === 'payment' ? paymentData.paymentDate : paymentData.createdAt) %>
                                        </span>
                                    </div>
                                    <% if (type === 'fine' && paymentData.paidDate) { %>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Tanggal Dibayar:</span>
                                            <span class="font-medium"><%= formatDate(paymentData.paidDate) %></span>
                                        </div>
                                    <% } %>
                                </div>
                            </div>

                            <div>
                                <h3 class="text-lg font-medium text-custom-dark mb-4">Bukti Pembayaran</h3>
                                <% if (paymentData.paymentProof) { %>
                                    <div class="space-y-3">
                                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-4 text-center">
                                            <img src="/uploads/<%= paymentData.paymentProof %>" 
                                                 alt="Bukti Pembayaran" 
                                                 class="max-w-full h-auto mx-auto max-h-48 object-contain rounded">
                                        </div>
                                        <a href="/uploads/<%= paymentData.paymentProof %>" 
                                           target="_blank" 
                                           class="block w-full text-center px-4 py-2 bg-custom-green text-white rounded-lg hover:bg-custom-green-dark transition">
                                            <i class="fas fa-external-link-alt mr-2"></i>
                                            Lihat Bukti Lengkap
                                        </a>
                                    </div>
                                <% } else { %>
                                    <div class="text-center py-8 text-gray-500">
                                        <i class="fas fa-file-image text-4xl mb-2"></i>
                                        <p>Tidak ada bukti pembayaran</p>
                                    </div>
                                <% } %>
                            </div>
                        </div>
                    </div>

                    <!-- Order Information -->
                    <div class="bg-white rounded-xl shadow-md border border-gray-200 p-6">
                        <h2 class="text-xl font-semibold text-custom-dark mb-6">Informasi Pesanan</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span class="text-gray-600">ID Pesanan:</span>
                                    <span class="font-medium">#<%= orderData.id %></span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Status Pesanan:</span>
                                    <span class="px-2 py-1 text-xs font-semibold rounded-full <%= getStatusClass(orderData.status) %>">
                                        <%= getStatusText(orderData.status) %>
                                    </span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Total Pesanan:</span>
                                    <span class="font-medium"><%= formatNumber(orderData.totalAmount) %></span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Tanggal Pesanan:</span>
                                    <span class="font-medium"><%= formatDate(orderData.createdAt) %></span>
                                </div>
                                <% if (orderData.returnDate) { %>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Tanggal Pengembalian:</span>
                                        <span class="font-medium"><%= formatDate(orderData.returnDate) %></span>
                                    </div>
                                <% } %>
                            </div>
                            <div class="text-right">
                                <a href="/user/orders/<%= orderData.id %>" 
                                   class="inline-flex items-center px-4 py-2 bg-custom-green text-white rounded-lg hover:bg-custom-green-dark transition">
                                    <i class="fas fa-eye mr-2"></i>
                                    Lihat Detail Pesanan
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sidebar -->
                <div class="space-y-6">
                    <!-- Item/Service Information -->
                    <% if (itemDetails) { %>
                        <div class="bg-white rounded-xl shadow-md border border-gray-200 p-6">
                            <h2 class="text-xl font-semibold text-custom-dark mb-4">
                                <%= orderData.itemType === 'item' ? 'Item' : 'Layanan' %>
                            </h2>
                            <div class="space-y-4">
                                <% if (itemDetails.image) { %>
                                    <div class="text-center">
                                        <img src="/uploads/<%= itemDetails.image %>" 
                                             alt="<%= itemDetails.name %>" 
                                             class="w-full h-48 object-cover rounded-lg">
                                    </div>
                                <% } %>
                                <div>
                                    <h3 class="font-semibold text-lg text-custom-dark mb-2"><%= itemDetails.name %></h3>
                                    <p class="text-gray-600 text-sm mb-3"><%= itemDetails.description %></p>
                                    <div class="flex justify-between items-center">
                                        <span class="text-gray-600">Harga:</span>
                                        <span class="font-semibold text-lg"><%= formatNumber(itemDetails.price) %></span>
                                    </div>
                                    <% if (itemDetails.category) { %>
                                        <div class="mt-2">
                                            <span class="inline-block px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded">
                                                <%= itemDetails.category %>
                                            </span>
                                        </div>
                                    <% } %>
                                </div>
                            </div>
                        </div>
                    <% } %>

                    <!-- Quick Actions -->
                    <div class="bg-white rounded-xl shadow-md border border-gray-200 p-6">
                        <h2 class="text-xl font-semibold text-custom-dark mb-4">Aksi Cepat</h2>
                        <div class="space-y-3">
                            <a href="/user/payments" 
                               class="block w-full text-center px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition">
                                <i class="fas fa-list mr-2"></i>
                                Kembali ke Riwayat
                            </a>
                            <a href="/user/orders/<%= orderData.id %>" 
                               class="block w-full text-center px-4 py-2 bg-custom-green text-white rounded-lg hover:bg-custom-green-dark transition">
                                <i class="fas fa-eye mr-2"></i>
                                Lihat Pesanan
                            </a>
                            <% if (paymentData.paymentProof) { %>
                                <a href="/uploads/<%= paymentData.paymentProof %>" 
                                   target="_blank" 
                                   class="block w-full text-center px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition">
                                    <i class="fas fa-download mr-2"></i>
                                    Download Bukti
                                </a>
                            <% } %>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        <%- include('../partials/footer') %>
    </div>
</body>
</html> 